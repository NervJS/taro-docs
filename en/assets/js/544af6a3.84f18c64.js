"use strict";(self.webpackChunktaro_docs=self.webpackChunktaro_docs||[]).push([[42141],{47632:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>y,frontMatter:()=>i,metadata:()=>u,toc:()=>p});r(37953);var n=r(58860);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function a(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const i={title:"Taro.getUserProfile(option)",sidebar_label:"getUserProfile"},s=void 0,u={unversionedId:"apis/open-api/user-info/getUserProfile",id:"version-3.x/apis/open-api/user-info/getUserProfile",title:"Taro.getUserProfile(option)",description:"Gets information about the user. The authorization dialog pops up with each request and returns userInfo when the user agrees.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-3.x/apis/open-api/user-info/getUserProfile.md",sourceDirName:"apis/open-api/user-info",slug:"/apis/open-api/user-info/getUserProfile",permalink:"/taro-docs/en/docs/3.x/apis/open-api/user-info/getUserProfile",draft:!1,editUrl:"https://github.com/nervjs/taro-docs/edit/master/versioned_docs/version-3.x/apis/open-api/user-info/getUserProfile.md",tags:[],version:"3.x",frontMatter:{title:"Taro.getUserProfile(option)",sidebar_label:"getUserProfile"},sidebar:"API",previous:{title:"getAccountInfoSync",permalink:"/taro-docs/en/docs/3.x/apis/open-api/account/getAccountInfoSync"},next:{title:"getUserInfo",permalink:"/taro-docs/en/docs/3.x/apis/open-api/user-info/getUserInfo"}},c={},p=[{value:"getUserProfile",id:"getuserprofile",level:2},{value:"Type",id:"type",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Option",id:"option",level:3},{value:"SuccessCallbackResult",id:"successcallbackresult",level:3},{value:"Sample Code",id:"sample-code",level:2},{value:"API Support",id:"api-support",level:2},{value:"Other",id:"other",level:2}],g={toc:p},d="wrapper";function y(e){var{components:t}=e,r=a(e,["components"]);return(0,n.yg)(d,l(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}({},g,r),{components:t,mdxType:"MDXLayout"}),(0,n.yg)("p",null,"Gets information about the user. The authorization dialog pops up with each request and returns ",(0,n.yg)("inlineCode",{parentName:"p"},"userInfo")," when the user agrees."),(0,n.yg)("admonition",{type:"tip"},(0,n.yg)("p",{parentName:"admonition"},"WeChat Foundation Library 2.10.4 started to support"),(0,n.yg)("p",{parentName:"admonition"},"Taro 2.2.17\uff0c3.0.29\uff0c3.1\uff0c3.2 already supported.")),(0,n.yg)("blockquote",null,(0,n.yg)("p",{parentName:"blockquote"},(0,n.yg)("a",{parentName:"p",href:"https://developers.weixin.qq.com/community/develop/doc/000cacfa20ce88df04cb468bc52801"},"WeChat adjustment background and instructions"))),(0,n.yg)("h2",{id:"getuserprofile"},"getUserProfile"),(0,n.yg)("p",null,"The user's personal information (avatar, nickname, gender and region) can be retrieved via the ",(0,n.yg)("inlineCode",{parentName:"p"},"Taro.getUserProfile")," interface. This interface is supported by WeChat since version ",(0,n.yg)("strong",{parentName:"p"},"2.10.4")," of the base library and returns only the user's personal information, not the user identifier. The desc attribute of this interface (declaring what the user's personal information will be used for) will be displayed in a pop-up window later, so please fill in the form carefully."),(0,n.yg)("p",null,"Each time a developer obtains personal information from a user through this interface, user confirmation is required, so please keep the user's quickly filled in avatar nickname safe to avoid repeated pop-ups."),(0,n.yg)("h2",{id:"type"},"Type"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-tsx"},"(option?: Option) => Promise<SuccessCallbackResult>\n")),(0,n.yg)("h2",{id:"parameters"},"Parameters"),(0,n.yg)("h3",{id:"option"},"Option"),(0,n.yg)("table",null,(0,n.yg)("thead",null,(0,n.yg)("tr",null,(0,n.yg)("th",null,"Property"),(0,n.yg)("th",null,"Type"),(0,n.yg)("th",{style:{textAlign:"center"}},"Required"),(0,n.yg)("th",null,"Description"))),(0,n.yg)("tbody",null,(0,n.yg)("tr",null,(0,n.yg)("td",null,"lang"),(0,n.yg)("td",null,(0,n.yg)("code",null,'"en" | "zh_CN" | "zh_TW"')),(0,n.yg)("td",{style:{textAlign:"center"}},"No"),(0,n.yg)("td",null,"The language of the displayed user information")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"desc"),(0,n.yg)("td",null,(0,n.yg)("code",null,"string")),(0,n.yg)("td",{style:{textAlign:"center"}},"Yes"),(0,n.yg)("td",null,"\u58f0\u660e\u83b7\u53d6\u7528\u6237\u4e2a\u4eba\u4fe1\u606f\u540e\u7684\u7528\u9014\uff0c\u4e0d\u8d85\u8fc7 30 \u4e2a\u5b57\u7b26")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"complete"),(0,n.yg)("td",null,(0,n.yg)("code",null,"(res: any) => void")),(0,n.yg)("td",{style:{textAlign:"center"}},"No"),(0,n.yg)("td",null,"The callback function used when the API call completed (always executed whether the call succeeds or fails)")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"fail"),(0,n.yg)("td",null,(0,n.yg)("code",null,"(res: any) => void")),(0,n.yg)("td",{style:{textAlign:"center"}},"No"),(0,n.yg)("td",null,"The callback function for a failed API call")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"success"),(0,n.yg)("td",null,(0,n.yg)("code",null,"(res: Result) => void")),(0,n.yg)("td",{style:{textAlign:"center"}},"No"),(0,n.yg)("td",null,"The callback function for a successful API call")))),(0,n.yg)("h3",{id:"successcallbackresult"},"SuccessCallbackResult"),(0,n.yg)("table",null,(0,n.yg)("thead",null,(0,n.yg)("tr",null,(0,n.yg)("th",null,"Property"),(0,n.yg)("th",null,"Type"),(0,n.yg)("th",null,"Description"))),(0,n.yg)("tbody",null,(0,n.yg)("tr",null,(0,n.yg)("td",null,"cloudID"),(0,n.yg)("td",null,(0,n.yg)("code",null,"string")),(0,n.yg)("td",null,"The Cloud ID corresponding to sensitive data. It is returned only in Mini Programs for which ",(0,n.yg)("a",{href:"https://developers.weixin.qq.com/miniprogram/en/dev/wxcloud/basis/getting-started.html"},"Cloud Base")," is enabled. The open data can be directly obtained via cloud call. See ",(0,n.yg)("a",{href:"https://developers.weixin.qq.com/miniprogram/en/dev/framework/open-ability/signature.html#method-cloud"},"details"),".")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"encryptedData"),(0,n.yg)("td",null,(0,n.yg)("code",null,"string")),(0,n.yg)("td",null,"The complete encrypted user data, including the sensitive data. For details, see ",(0,n.yg)("a",{href:"https://developers.weixin.qq.com/miniprogram/en/dev/framework/open-ability/signature.html#Encryption-Algorithm-for-Encrypted-Data"},"signature, verification, encryption, and decryption of user data"),".")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"iv"),(0,n.yg)("td",null,(0,n.yg)("code",null,"string")),(0,n.yg)("td",null,"The initial vector of the encryption algorithm. For details, see ",(0,n.yg)("a",{href:"https://developers.weixin.qq.com/miniprogram/en/dev/framework/open-ability/signature.html#Encryption-Algorithm-for-Encrypted-Data"},"signature, verification, encryption, and decryption of user data"),".")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"rawData"),(0,n.yg)("td",null,(0,n.yg)("code",null,"string")),(0,n.yg)("td",null,"Raw data string that excludes sensitive information and is used to calculate signatures.")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"signature"),(0,n.yg)("td",null,(0,n.yg)("code",null,"string")),(0,n.yg)("td",null,"The string generated with SHA-1 (rawData + sessionkey), which is used to verify the user information. For details, see ",(0,n.yg)("a",{href:"https://developers.weixin.qq.com/miniprogram/en/dev/framework/open-ability/signature.html#Encryption-Algorithm-for-Encrypted-Data"},"signature, verification, encryption, and decryption of user data"),".")),(0,n.yg)("tr",null,(0,n.yg)("td",null,"userInfo"),(0,n.yg)("td",null," UserInfo "),(0,n.yg)("td",null,"User information object, excluding openid and other sensitive information.")))),(0,n.yg)("h2",{id:"sample-code"},"Sample Code"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre",className:"language-tsx"},"Taro.getUserProfile({\n  desc: 'For completing member profiles',\n  success: (res) => {\n    this.setState({\n      userInfo: res.userInfo,\n      hasUserInfo: true\n    })\n  }\n})\n")),(0,n.yg)("h2",{id:"api-support"},"API Support"),(0,n.yg)("table",null,(0,n.yg)("thead",{parentName:"table"},(0,n.yg)("tr",{parentName:"thead"},(0,n.yg)("th",{parentName:"tr",align:"center"},"API"),(0,n.yg)("th",{parentName:"tr",align:"center"},"WeChat Mini-Program"),(0,n.yg)("th",{parentName:"tr",align:"center"},"H5"),(0,n.yg)("th",{parentName:"tr",align:"center"},"React Native"))),(0,n.yg)("tbody",{parentName:"table"},(0,n.yg)("tr",{parentName:"tbody"},(0,n.yg)("td",{parentName:"tr",align:"center"},"Taro.getUserProfile"),(0,n.yg)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,n.yg)("td",{parentName:"tr",align:"center"}),(0,n.yg)("td",{parentName:"tr",align:"center"})))),(0,n.yg)("h2",{id:"other"},"Other"),(0,n.yg)("p",null,"issue : ",(0,n.yg)("a",{parentName:"p",href:"https://github.com/NervJS/taro/issues/8810"},"Taro\u4ec0\u4e48\u65f6\u5019\u652f\u6301 getUserProfile \u65b9\u6cd5")))}y.isMDXComponent=!0},58860:(e,t,r)=>{r.d(t,{xA:()=>c,yg:()=>y});var n=r(37953);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),u=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):a(a({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(r),d=o,y=p["".concat(s,".").concat(d)]||p[d]||g[d]||l;return r?n.createElement(y,a(a({ref:t},c),{},{components:r})):n.createElement(y,a({ref:t},c))}));function y(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=r.length,a=new Array(l);a[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[p]="string"==typeof e?e:o,a[1]=i;for(var u=2;u<l;u++)a[u]=r[u];return n.createElement.apply(null,a)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"}}]);