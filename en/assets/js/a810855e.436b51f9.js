"use strict";(self.webpackChunktaro_docs=self.webpackChunktaro_docs||[]).push([[2508],{20288:(e,n,t)=>{t.d(n,{h9:()=>o,oS:()=>i,vR:()=>l});var a=t(37953);const o=()=>a.createElement("span",{className:"footer_link_connect_wrap"},a.createElement("span",{className:"footer_link_connect footer_link_wechat"},"WeChat Developer Group",a.createElement("span",{className:"wechat_qrcode_icon"},a.createElement("svg",{t:"1554966525626",className:"icon svgicon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"https://www.w3.org/2000/svg","p-id":"2588","data-spm-anchor-id":"a313x.7781069.0.i0"},a.createElement("path",{d:"M240.071 241.095h59.278v59.278h-59.278v-59.278z",fill:"","p-id":"2589"}),a.createElement("path",{d:"M405.959 134.485h-272.611v272.611h106.723v47.445h59.278v-47.445h106.723v-59.278h47.445v-47.445h-47.445l-0.114-165.888zM346.795 347.819h-154.169v-154.055h154.055v154.055h0.114zM240.071 727.154h59.278v59.278h-59.278v-59.278zM726.016 241.095h59.278v59.278h-59.278v-59.278zM512.683 509.042v63.943h59.278v-59.165h47.445v-59.278h-47.445v-47.445h-59.278v101.945zM512.683 725.789v60.643h59.278v-106.723h47.445v-59.278h-106.723v105.358zM571.961 786.432h47.445v47.445h-47.445v-47.445zM453.405 833.877v59.165h118.557v-59.165h-118.557z",fill:"","p-id":"2590"}),a.createElement("path",{d:"M678.685 679.709h-59.278v106.723h106.61v-59.278h-47.331v-47.445zM726.016 893.042h166.002v-59.165h-106.723v-47.445h-59.278v106.61zM892.018 513.821v-59.278h-106.723v59.278h106.723zM832.739 727.154h59.278v59.278h-59.278v-59.278zM453.405 347.819h59.278v59.278h-59.278v-59.278zM726.016 454.542v-47.445h166.002v-272.611h-272.611v59.278h-106.723v47.445h106.723v59.165h-47.445v47.445h47.445v59.278h59.278v47.445h47.331zM678.685 193.763h154.055v154.055h-154.055v-154.055zM678.685 572.985h47.331v47.445h-47.331v-47.445zM785.294 679.709h-59.278v47.445h106.723v-106.723h59.278v-47.445h-106.723v106.723zM453.405 241.095h59.278v59.278h-59.278v-59.278zM299.349 513.821h47.445v59.165h-47.445v-59.165zM453.405 454.542h-106.61v59.278h59.165v59.165h47.445v-118.443z",fill:"","p-id":"2591"}),a.createElement("path",{d:"M405.959 786.432v-106.723h47.445v-59.278h-213.333v-106.61h-106.723v59.278h59.278v47.445h-59.278v272.611h272.611v-59.278h47.445v-47.445h-47.445zM346.795 833.877h-154.169v-154.169h154.055v154.169h0.114zM453.405 572.985h59.278v47.445h-59.278v-47.445zM619.406 513.821h59.278v59.165h-59.278v-59.165zM726.016 513.821h59.278v59.165h-59.278v-59.165z",fill:"","p-id":"2592"})))),a.createElement("span",{className:"footer_link_wechat_img inline"},a.createElement("img",{src:"https://camo.githubusercontent.com/10834a234b99a5880b5dff7c0ca7235e2a0772e7/687474703a2f2f696d6732302e333630627579696d672e636f6d2f7562612f6a66732f7432303139372f3238332f313638373136383837342f3133363034322f32623464383131662f35623330613635634e39643166303366312e706e67"})));function i(){return a.createElement("span",null,a.createElement("svg",{xmlns:"https://www.w3.org/2000/svg",className:"inline-svg-icon",viewBox:"0 0 1024 1024"},a.createElement("defs",null,a.createElement("style",null)),a.createElement("path",{fill:"#41B883",d:"M615.6 123.6h165.5L512 589.7 242.9 123.6H63.5L512 900.4l448.5-776.9z"}),a.createElement("path",{fill:"#34495E",d:"M781.1 123.6H615.6L512 303 408.4 123.6H242.9L512 589.7z"})),a.createElement("span",{style:{color:s}},"Vue"))}const r="#61dafb",s="#4fc08d";function l(){return a.createElement("span",null,a.createElement("svg",{xmlns:"https://www.w3.org/2000/svg",width:"200",height:"200",className:"inline-svg-icon",viewBox:"0 0 1024 1024"},a.createElement("defs",null,a.createElement("style",null)),a.createElement("path",{fill:"#61DAFB",d:"M432 511.8a80 80 0 10160 0 80 80 0 10-160 0z"}),a.createElement("path",{fill:"#61DAFB",d:"M960.5 511.8c0-62.8-73.8-117.2-188.5-150.1 28.9-115.8 18.7-206.9-35.7-238.3-54.5-31.4-138.5 5.3-224.3 88.2-85.8-82.9-169.8-119.6-224.3-88.2-54.4 31.4-64.6 122.6-35.7 238.3C137.3 394.6 63.5 449 63.5 511.8S137.3 629 252 661.9c-28.9 115.7-18.7 206.9 35.7 238.3 13.4 7.8 28.6 11.6 45.2 11.6 39.7 0 87.8-21.8 140-64.2 13-10.6 26.1-22.6 39.1-35.2 13 12.6 26.1 24.6 39.1 35.2 52.2 42.4 100.2 64.2 140 64.2 16.6 0 31.8-3.8 45.2-11.6 54.4-31.4 64.6-122.5 35.7-238.3 114.7-32.9 188.5-87.3 188.5-150.1zM716.8 157.2c35.3 20.4 42.7 94.3 17.6 194.8-36.7-8.4-76.7-14.7-119.3-18.6-24.7-34.9-50.2-66.4-75.8-94 59.2-57.3 114.2-88.4 152-88.4 9.6-.1 18.2 2 25.5 6.2zM637 584c-13.8 24-28.4 47-43.3 69-26.1 2-53.3 3.1-81.7 3.1-28.3 0-55.5-1.1-81.6-3.1-15-22-29.5-45.1-43.3-69-14.1-24.5-26.7-48.6-38.1-72.2 11.4-23.6 24-47.7 38.1-72.2 14.1-24.5 28.7-47.4 43.4-69.1 26.1-2 53.3-3.1 81.6-3.1 28.3 0 55.5 1.1 81.6 3.1 14.7 21.6 29.3 44.6 43.4 69 14.1 24.5 26.7 48.6 38.1 72.2-11.5 23.7-24.1 47.8-38.2 72.3zm58.8-26.4c11.2 26.6 20.4 52.1 28 76.5-24.9 5.6-51.7 10.4-80.3 14 9.3-14.5 18.4-29.3 27.3-44.6 8.8-15.4 17.1-30.7 25-45.9zM512 756.5c-17.7-19.2-35.1-40.1-52.2-62.6 17.1.8 34.5 1.3 52.2 1.3 17.7 0 35.1-.5 52.2-1.3-17.1 22.5-34.5 43.4-52.2 62.6zM380.5 648.1c-28.6-3.6-55.3-8.4-80.3-14 7.6-24.4 16.8-49.9 28-76.5 7.9 15.2 16.1 30.5 25 45.9 8.9 15.2 18 30 27.3 44.6zM328.2 466c-11.2-26.6-20.4-52.1-28-76.5 24.9-5.6 51.6-10.4 80.2-14-9.2 14.4-18.4 29.2-27.2 44.6-8.8 15.4-17.1 30.7-25 45.9zM512 267.1c17.3 18.7 34.8 39.8 52.1 62.7-17.1-.8-34.4-1.3-52.1-1.3-17.7 0-35 .5-52.1 1.3 17.3-22.9 34.8-44 52.1-62.7zm158.7 153c-8.9-15.3-18-30.1-27.2-44.6 28.6 3.6 55.3 8.4 80.2 14-7.6 24.4-16.8 49.9-28 76.5-7.8-15.2-16.1-30.5-25-45.9zM307.2 157.2c7.2-4.2 15.8-6.2 25.6-6.2 37.8 0 92.7 31.1 151.9 88.4-25.6 27.6-51.1 59.2-75.8 94-42.5 3.9-82.6 10.2-119.3 18.6-25.1-100.6-17.6-174.5 17.6-194.8zM102.5 511.8c0-40.8 60.3-84.2 160-112.6 11.1 36 25.6 73.8 43.5 112.6-17.8 38.8-32.4 76.6-43.5 112.6-99.7-28.4-160-71.9-160-112.6zm345.8 305.5c-59.7 48.5-111.1 66.4-141.1 49.2-35.3-20.4-42.7-94.3-17.6-194.8 36.7 8.4 76.7 14.7 119.3 18.6 24.4 34.5 49.9 66.1 75.8 94.2-12.1 11.7-24.2 22.9-36.4 32.8zm268.5 49.2c-29.9 17.3-81.4-.6-141.1-49.2-12.1-9.9-24.3-21.1-36.5-32.8 26-28.1 51.4-59.7 75.8-94.2 42.5-3.9 82.6-10.2 119.3-18.7 25.2 100.6 17.7 174.5-17.5 194.9zm44.8-242.1c-11.1-36-25.6-73.8-43.5-112.6 17.8-38.8 32.4-76.6 43.5-112.6 99.7 28.5 160 71.9 160 112.6-.1 40.7-60.4 84.2-160 112.6z"})),a.createElement("span",{style:{color:r}},"React"))}},93660:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>g,contentTitle:()=>c,default:()=>f,frontMatter:()=>d,metadata:()=>m,toc:()=>u});t(37953);var a=t(58860),o=t(20288),i=t(13669),r=t(47756);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function p(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}const d={title:"Progressive Introduction Tutorial"},c=void 0,m={unversionedId:"guide",id:"guide",title:"Progressive Introduction Tutorial",description:"Before we start",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/guide.mdx",sourceDirName:".",slug:"/guide",permalink:"/taro-docs/en/docs/guide",draft:!1,editUrl:"https://github.com/nervjs/taro-docs/edit/master/docs/guide.mdx",tags:[],version:"current",frontMatter:{title:"Progressive Introduction Tutorial"}},g={},u=[{value:"Before we start",id:"before-we-start",level:2},{value:"Pre-requisite knowledge",id:"pre-requisite-knowledge",level:3},{value:"Environment Preparation",id:"environment-preparation",level:2},{value:"Editor",id:"editor",level:3},{value:"Terminal",id:"terminal",level:3},{value:"macOS/Linux",id:"macoslinux",level:4},{value:"Windows",id:"windows",level:4},{value:"Seeking help",id:"seeking-help",level:3},{value:"Basic Tutorial",id:"basic-tutorial",level:2},{value:"Entry Component",id:"entry-component",level:3},{value:"Page Component",id:"page-component",level:3},{value:"Custom components",id:"custom-components",level:3},{value:"Router And Tabbar",id:"router-and-tabbar",level:3},{value:"Project Progression and Optimization",id:"project-progression-and-optimization",level:2},{value:"Status Management",id:"status-management",level:3},{value:"Other status management tools",id:"other-status-management-tools",level:4},{value:"CSS Tools",id:"css-tools",level:3},{value:"Render HTML",id:"render-html",level:3},{value:"Performance Optimization",id:"performance-optimization",level:3},{value:"Virtual List",id:"virtual-list",level:4},{value:"Prerender",id:"prerender",level:4},{value:"Packing volume",id:"packing-volume",level:3},{value:"JavaScript",id:"javascript",level:4},{value:"Packaged volume analysis",id:"packaged-volume-analysis",level:4},{value:"SubPackages",id:"subpackages",level:4},{value:"Custom Compilation",id:"custom-compilation",level:3},{value:"Extending with Webpack",id:"extending-with-webpack",level:4},{value:"Expansion with plugin system",id:"expansion-with-plugin-system",level:4},{value:"Multi-Ended Development",id:"multi-ended-development",level:2},{value:"Cross-platform development",id:"cross-platform-development",level:3},{value:"Synchronized debugging",id:"synchronized-debugging",level:3},{value:"Using native mini program components",id:"using-native-mini-program-components",level:3}],h={toc:u},y="wrapper";function f(e){var{components:n}=e,t=p(e,["components"]);return(0,a.yg)(y,l(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),a.forEach((function(n){s(e,n,t[n])}))}return e}({},h,t),{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h2",{id:"before-we-start"},"Before we start"),(0,a.yg)("p",null,"We will develop a simple V2EX forum client in this tutorial and you will learn the basics, concepts and some optimization techniques of Taro in this section. Learning this knowledge does not require prior knowledge of Taro, mini program development or multi-site development. Once you have this knowledge, you should be able to develop multi-applications quickly and efficiently."),(0,a.yg)("admonition",{title:"Tips",type:"tip"},(0,a.yg)("p",{parentName:"admonition"},"This tutorial is for developers who like to learn as they go or have no prior knowledge of mini program development at all, if you prefer to learn step by step, please include the entire contents of ",(0,a.yg)("a",{parentName:"p",href:"./"},"documentation")," in its entirety. When you finish reading the ",(0,a.yg)("a",{parentName:"p",href:"./"},"documentation")," you will see that this tutorial is an asymptotic index of the documentation.")),(0,a.yg)("p",null,"This tutorial will be divided into four chapters."),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"[Environment preparation]","(#Environment preparation): what needs to be installed when we use Taro."),(0,a.yg)("li",{parentName:"ul"},"[Basic tutorial]","(#Basic tutorial): basic concepts and development guidelines for Taro."),(0,a.yg)("li",{parentName:"ul"},"[Project Progression and Optimization]","(#Project Progression and Optimization): what should be done to maintain or improve the maintainability and performance of the application as the project gets bigger and slower."),(0,a.yg)("li",{parentName:"ul"},"[Multi-Ended Development]","(#Multi-Ended Development): How to quickly expand to a multi-ended application when you have already developed one end of the application using Taro.")),(0,a.yg)("p",null,"(If you're browsing on a large screen) The title directory to the right of this tutorial contains subdirectories for all the chapters, so you can view or navigate to the chapter you're interested in."),(0,a.yg)("h3",{id:"pre-requisite-knowledge"},"Pre-requisite knowledge"),(0,a.yg)("p",null,"In this tutorial we assume that you already have some knowledge of web front-end development and JavaScript. We will implement our application using the ",(0,a.yg)(o.vR,{mdxType:"ReactIcon"})," and ",(0,a.yg)(o.oS,{mdxType:"VueIcon"})," frameworks respectively, switching between implementations by clicking on the ",(0,a.yg)(o.vR,{mdxType:"ReactIcon"})," or ",(0,a.yg)(o.oS,{mdxType:"VueIcon"})," buttons in the code examples. If you are not familiar with either framework, you can cross reference the code implementation via ",(0,a.yg)("a",{parentName:"p",href:"https://zh-hans.reactjs.org/"},"React documentation")," or ",(0,a.yg)("a",{parentName:"p",href:"https://cn.vuejs.org/"},"Vue documentation"),"."),(0,a.yg)("p",null,"Our code implementation also uses some ES6 syntax, which you can see or learn about at ",(0,a.yg)("a",{parentName:"p",href:"https://es6.ruanyifeng.com/"},"ES6 Getting Started Tutorial")),(0,a.yg)("h2",{id:"environment-preparation"},"Environment Preparation"),(0,a.yg)("p",null,"Currently Taro offers only one development method: installing the Taro command line tool (Taro CLI) for development."),(0,a.yg)("p",null,"The Taro CLI relies on the Node.js environment, so it must be installed on your machine. There are various ways to install the Node.js environment, if you don't know Node.js at all you can visit the ",(0,a.yg)("a",{parentName:"p",href:"https://nodejs.org/en/"},"Node.js official website")," to download an executable to install it. We recommend installing the LTS version of Node.js (currently LTS version is v12)."),(0,a.yg)("p",null,"When your machine already has a Node.js environment, you can install the Taro CLI by entering the command ",(0,a.yg)("inlineCode",{parentName:"p"},"npm i -g @tarojs/cli")," in the terminal. Once installed, enter the command ",(0,a.yg)("inlineCode",{parentName:"p"},"taro")," in the terminal and if something like this appears, the installation was successful."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"\ud83d\udc7d Taro v3.0.0-beta.6\n\nUsage: taro <command> [options]\n\nOptions:\n  -V, --version       output the version number\n  -h, --help          output usage information\n\nCommands:\n  init [projectName]  Init a project with default templete\n  config <cmd>        Taro config\n  create              Create page for project\n  build               Build a project with options\n  update              Update packages of taro\n  convert             Convert weapp to taro\n  info                Diagnostics Taro env info\n  doctor              Diagnose taro project\n  help [cmd]          display help for [cmd]\n")),(0,a.yg)("h3",{id:"editor"},"Editor"),(0,a.yg)("p",null,"We recommend using ",(0,a.yg)("a",{parentName:"p",href:"https://code.visualstudio.com/"},"VSCode")," or ",(0,a.yg)("a",{parentName:"p",href:"https://www.jetbrains.com/webstorm/"},"WebStorm")," (or other Jetbrains IDEs that support web development)."),(0,a.yg)("p",null,"When you use VSCode, it is recommended to install the ",(0,a.yg)("a",{parentName:"p",href:"https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint"},"ESLint plugin"),", and if you use TypeScript, don't forget to configure ",(0,a.yg)("inlineCode",{parentName:"p"}," eslint.probe")," parameter if you use TypeScript. If you use Vue, it is recommended to install the ",(0,a.yg)("a",{parentName:"p",href:"https://marketplace.visualstudio.com/items?itemName=octref.vetur"},"Vetur")," plugin."),(0,a.yg)("p",null,"If you are willing to spend money and are lazy you can choose ",(0,a.yg)("a",{parentName:"p",href:"https://www.jetbrains.com/webstorm/"},"WebStorm")," (or any other Jetbrains IDE that supports web development), which requires basically no configuration."),(0,a.yg)("p",null,"Whether you use VSCode or WebStrom, you can use Taro for auto-completion and live code inspection (linting) after installing the above plugin."),(0,a.yg)("h3",{id:"terminal"},"Terminal"),(0,a.yg)("h4",{id:"macoslinux"},"macOS/Linux"),(0,a.yg)("p",null,"What tool is used by the terminal emulator on *nix systems (Terminal/iTerm2/Konsole/Hyper/etc...) It doesn't matter, but for running the Taro CLI shell we recommend ",(0,a.yg)("inlineCode",{parentName:"p"},"bash")," or ",(0,a.yg)("inlineCode",{parentName:"p"},"zsh"),"."),(0,a.yg)("h4",{id:"windows"},"Windows"),(0,a.yg)("p",null,"On Windows we recommend using the built-in ",(0,a.yg)("inlineCode",{parentName:"p"},"cmd")," or ",(0,a.yg)("inlineCode",{parentName:"p"},"PowerShell"),". If available, we recommend installing ",(0,a.yg)("a",{parentName:"p",href:"https://docs.microsoft.com/zh-cn/windows/wsl/install-win10"},"WSL")," and running the Taro CLI from a terminal in the Linux distribution. Windows extremes may not have been taken into account, resulting in bugs."),(0,a.yg)("h3",{id:"seeking-help"},"Seeking help"),(0,a.yg)("p",null,"When you encounter a problem during development, you can scan the code to join ",(0,a.yg)(o.h9,{mdxType:"Wechat"})," and ask a question, or go to ",(0,a.yg)("a",{parentName:"p",href:"https://taro-club.jd.com/"},"Taro Community")," and ask a question. When you're sure there's a bug in Taro, feel free to ask your question to the ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/NervJS/taro/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc"},"Taro GitHub Issue"),"."),(0,a.yg)("h2",{id:"basic-tutorial"},"Basic Tutorial"),(0,a.yg)("p",null,"After installing the Taro CLI you can create a brand new project with the ",(0,a.yg)("inlineCode",{parentName:"p"},"taro init")," command, you can fill in the options according to your project needs, a minimal version of a Taro project will include the following files."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"\u251c\u2500\u2500 babel.config.js             # Babel Configuration\n\u251c\u2500\u2500 .eslintrc.js                # ESLint Configuration\n\u251c\u2500\u2500 config                      # Compile configuration directory\n\u2502   \u251c\u2500\u2500 dev.js                  # Development Mode Configuration\n\u2502   \u251c\u2500\u2500 index.js                # Default Configuration\n\u2502   \u2514\u2500\u2500 prod.js                 # Production Mode Configuration\n\u251c\u2500\u2500 package.json                # Node.js manifest\n\u251c\u2500\u2500 dist                        # Packaged Directory\n\u251c\u2500\u2500 project.config.json         # Mini Program Project Configuration\n\u251c\u2500\u2500 src # \u6e90\u7801\u76ee\u5f55\n\u2502   \u251c\u2500\u2500 app.config.js           # Global Configuration\n\u2502   \u251c\u2500\u2500 app.css                 # Global CSS\n\u2502   \u251c\u2500\u2500 app.js                  # Entry Component\n\u2502   \u251c\u2500\u2500 index.html              # H5 Entry HTML\n\u2502   \u2514\u2500\u2500 pages                   # Page Component\n\u2502       \u2514\u2500\u2500 index\n\u2502           \u251c\u2500\u2500 index.config.js # Page Configuration\n\u2502           \u251c\u2500\u2500 index.css       # Page CSS\n\u2502           \u2514\u2500\u2500 index.jsx       # Page Component,If the Vue project, this file is index.vue\n")),(0,a.yg)("p",null,"We will explain what each file does later, but for now, let's focus on the ",(0,a.yg)("inlineCode",{parentName:"p"},"src")," folder, which is the source directory."),(0,a.yg)("h3",{id:"entry-component"},"Entry Component"),(0,a.yg)("p",null,"Every Taro project has an entry component and an entry configuration where we can set the global state/global lifecycle, a minimized entry component would look like this."),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/app.js"',title:'"src/app.js"'},"import React, { Component } from 'react'\nimport './app.css'\n\nclass App extends Component {\n  render () {\n    // this.props.children is the page that will be rendered\n    return this.props.children\n  }\n}\n\n// Each entry component must export a React component\nexport default App\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="src/app.js"',title:'"src/app.js"'},"import Vue from 'vue'\nimport './app.css'\n\nconst App = {\n  render(h) {\n    // this.$slots.default is the page that will be rendered\n    return h('block', this.$slots.default)\n  }\n}\n\nexport default App\n")))),(0,a.yg)("p",null,"Each entry component (e.g. ",(0,a.yg)("inlineCode",{parentName:"p"},"app.js"),") is always accompanied by a global configuration file (e.g. ",(0,a.yg)("inlineCode",{parentName:"p"},"app.config.js"),") in which we can set the path, global window, routing, etc. of the page component. A minimal global configuration is as follows"),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="src/app.config.js"',title:'"src/app.config.js"'},"export default {\n  pages: [\n    'pages/index/index'\n  ]\n}\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="src/app.config.js"',title:'"src/app.config.js"'},"export default {\n  pages: [\n    'pages/index/index'\n  ]\n}\n")))),(0,a.yg)("p",null,"You may notice that the global configuration is the same for both ",(0,a.yg)(o.vR,{mdxType:"ReactIcon"})," and ",(0,a.yg)(o.oS,{mdxType:"VueIcon"}),". This is in the configuration file, Taro doesn't care about the framework difference, the Taro CLI will execute the globally configured code directly in the Node.js environment at compile time and serialize the ",(0,a.yg)("inlineCode",{parentName:"p"},"export default")," exported object to a JSON file. Next we'll talk about ","[page configuration]","(# page components) which also executes the same logic."),(0,a.yg)("p",null,"Therefore, we must ensure that the configuration file is executable in the Node.js environment, and not use some package or code that can only run in the H5 environment or mini program environment, otherwise the compilation will fail."),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"Taro's entry component and global configuration specifications are based on WeChat mini programs and are unified for the entire platform.\nYou can access the ",(0,a.yg)("a",{parentName:"p",href:"./react-entry"},"React entry component")," and ",(0,a.yg)("a",{parentName:"p",href:"./vue-entry"},"Vue-entry"),", and ",(0,a.yg)("a",{parentName:"p",href:"./app-config"},"global-config")," for details on the entry components and global configuration.")),(0,a.yg)("h3",{id:"page-component"},"Page Component"),(0,a.yg)("p",null,"Page components are the pages that will be rendered by each route. Taro's pages are placed in ",(0,a.yg)("inlineCode",{parentName:"p"},"src/pages")," by default, and every Taro project has at least one page component. In our generated project, there is a page component: ",(0,a.yg)("inlineCode",{parentName:"p"},"src/pages/index/index"),", and if you are careful, you can see that this path happens to correspond to the ",(0,a.yg)("inlineCode",{parentName:"p"},"pages")," of our ",(0,a.yg)("a",{parentName:"p",href:"./app-config"},"global configuration")," in the ",(0,a.yg)("inlineCode",{parentName:"p"},"pages")," field. A simple page component would look like this."),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/pages/index/index.jsx"',title:'"src/pages/index/index.jsx"'},"import { View } from '@tarojs/components'\nclass Index extends Component {\n  state = {\n    msg: 'Hello World!'\n  }\n\n  onReady () {\n    console.log('onReady')\n  }\n\n  render () {\n    return <View>{ this.state.msg }</View>\n  }\n}\n\nexport default Index\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/pages/index/index.vue"',title:'"src/pages/index/index.vue"'},"<template>\n  <view>\n    {{ msg }}\n  </view>\n</template>\n\n<script>\n\nexport default {\n  data() {\n    return {\n      msg: 'Hello World!'\n    };\n  },\n  onReady () {\n    console.log('onReady')\n  }\n};\n<\/script>\n")))),(0,a.yg)("p",null,"Isn't this the familiar ",(0,a.yg)(o.vR,{mdxType:"ReactIcon"})," and ",(0,a.yg)(o.oS,{mdxType:"VueIcon"})," components! But there are two subtle differences."),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("inlineCode",{parentName:"li"},"onReady")," lifecycle function. Taro injects most of the mini program specification page lifecycle into the page component at runtime, while the lifecycle of React or Vue is also fully functional."),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("inlineCode",{parentName:"li"},"View")," component. This is a cross-platform component from ",(0,a.yg)("inlineCode",{parentName:"li"},"@tarojs/components"),". As opposed to the familiar ",(0,a.yg)("inlineCode",{parentName:"li"},"div")," and ",(0,a.yg)("inlineCode",{parentName:"li"},"span")," elements, in Taro we are going to use all such cross-platform components for development.")),(0,a.yg)("p",null,"Like the portal component, each page component (e.g. ",(0,a.yg)("inlineCode",{parentName:"p"},"index.vue"),") will also have a page configuration (e.g. ",(0,a.yg)("inlineCode",{parentName:"p"},"index.config.js"),"), where we can set the page's navigation bar, background color, and other parameters."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/pages/index/index.config.js"',title:'"src/pages/index/index.config.js"'},"export default {\n  navigationBarTitleText: 'Home'\n}\n")),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"Taro's page hook functions and page configuration specifications are based on WeChat mini program and are unified for the entire platform.\nYou can access the ",(0,a.yg)("a",{parentName:"p",href:"./react-page"},"React page component")," and ",(0,a.yg)("a",{parentName:"p",href:"./vue-page"},"Vue page component")," for a full list of page hook functions and page configuration specifications.")),(0,a.yg)("h3",{id:"custom-components"},"Custom components"),(0,a.yg)("p",null,"If you've made it this far, you have to be congratulated for understanding the most complex concepts in Taro: entry components and page components, and how they interact (via configuration files). The next part, if you are already familiar with ",(0,a.yg)(o.vR,{mdxType:"ReactIcon"})," or ",(0,a.yg)(o.oS,{mdxType:"VueIcon"})," and web development, is too simple."),(0,a.yg)("p",null,"Let's start by writing the front page, which has a simple logic: display the latest forum posts."),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/pages/index/index.jsx"',title:'"src/pages/index/index.jsx"'},"import Taro from '@tarojs/taro'\nimport React from 'react'\nimport { View } from '@tarojs/components'\nimport { ThreadList } from '../../components/thread_list'\nimport api from '../../utils/api'\n\nimport './index.css'\n\nclass Index extends React.Component {\n  config = {\n    navigationBarTitleText: 'home'\n  }\n\n  state = {\n    loading: true,\n    threads: []\n  }\n\n  async componentDidMount () {\n    try {\n      const res = await Taro.request({\n        url: api.getLatestTopic()\n      })\n      this.setState({\n        threads: res.data,\n        loading: false\n      })\n    } catch (error) {\n      Taro.showToast({\n        title: 'Error loading remote data'\n      })\n    }\n  }\n\n  render () {\n    const { loading, threads } = this.state\n    return (\n      <View className='index'>\n        <ThreadList\n          threads={threads}\n          loading={loading}\n        />\n      </View>\n    )\n  }\n}\n\nexport default Index\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/pages/index/index.vue"',title:'"src/pages/index/index.vue"'},"<template>\n  <view class='index'>\n    <thread-list\n      :threads=\"threads\"\n      :loading=\"loading\"\n    />\n  </view>\n</template>\n\n<script>\nimport Vue from 'vue'\nimport Taro from '@tarojs/taro'\nimport api from '../../utils/api'\nimport ThreadList from '../../components/thread_list.vue'\nexport default {\n  components: {\n    'thread-list': ThreadList\n  },\n  data () {\n    return {\n      loading: true,\n      threads: []\n    }\n  },\n  async created() {\n    try {\n      const res = await Taro.request({\n        url: api.getLatestTopic()\n      })\n      this.loading = false\n      this.threads = res.data\n    } catch (error) {\n      Taro.showToast({\n        title: 'Error loading remote data'\n      })\n    }\n  }\n}\n<\/script>\n")))),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"You may notice that sending requests in a Taro app is done by ",(0,a.yg)("inlineCode",{parentName:"p"},"Taro.request()"),".\nLike page configuration and global configuration, Taro's API specification is based on the WeChat mini program and is unified for the whole platform.\nYou can find it in the ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/apis/about/desc"},"API documentation")," to find all the APIs.")),(0,a.yg)("p",null,"In our home page component, there is also a reference to a ",(0,a.yg)("inlineCode",{parentName:"p"},"ThreadList")," component, which we will now implement."),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/components/thread_list.jsx"',title:'"src/components/thread_list.jsx"'},"import React from 'react'\nimport { View, Text } from '@tarojs/components'\nimport { Thread } from './thread'\nimport { Loading } from './loading'\n\nimport './thread.css'\n\nclass ThreadList extends React.Component {\n  static defaultProps = {\n    threads: [],\n    loading: true\n  }\n\n  render () {\n    const { loading, threads } = this.props\n\n    if (loading) {\n      return <Loading />\n    }\n\n    const element = threads.map((thread, index) => {\n      return (\n        <Thread\n          key={thread.id}\n          node={thread.node}\n          title={thread.title}\n          last_modified={thread.last_modified}\n          replies={thread.replies}\n          tid={thread.id}\n          member={thread.member}\n        />\n      )\n    })\n\n    return (\n      <View className='thread-list'>\n        {element}\n      </View>\n    )\n  }\n}\n\nexport { ThreadList }\n")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/components/thread.jsx"',title:'"src/components/thread.jsx"'},"import Taro, { eventCenter } from '@tarojs/taro'\nimport React from 'react'\nimport { View, Text, Navigator, Image } from '@tarojs/components'\n\nimport api from '../utils/api'\nimport { timeagoInst, Thread_DETAIL_NAVIGATE } from '../utils'\n\nclass Thread extends React.Component {\n\n  handleNavigate = () => {\n    const { tid, not_navi } = this.props\n    if (not_navi) {\n      return\n    }\n    eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.props)\n    // \u8df3\u8f6c\u5230\u5e16\u5b50\u8be6\u60c5\n    Taro.navigateTo({\n      url: '/pages/thread_detail/thread_detail'\n    })\n  }\n\n  render () {\n    const { title, member, last_modified, replies, node, not_navi } = this.props\n    const time = timeagoInst.format(last_modified * 1000, 'zh')\n    const usernameCls = `author ${not_navi ? 'bold' : ''}`\n\n    return (\n      <View className='thread' onClick={this.handleNavigate}>\n        <View className='info'>\n          <View>\n            <Image src={member.avatar_large} className='avatar' />\n          </View>\n          <View className='middle'>\n            <View className={usernameCls}>\n                {member.username}\n            </View>\n            <View className='replies'>\n              <Text className='mr10'>\n                {time}\n              </Text>\n              <Text>\n                \u8bc4\u8bba {replies}\n              </Text>\n            </View>\n          </View>\n          <View className='node'>\n            <Text className='tag'>\n              {node.title}\n            </Text>\n          </View>\n        </View>\n        <Text className='title'>\n          {title}\n        </Text>\n      </View>\n    )\n  }\n}\n\nexport { Thread }\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/components/thread_list.vue"',title:'"src/components/thread_list.vue"'},'<template>\n  <view className=\'thread-list\'>\n    <loading v-if="loading" />\n    <thread\n      v-else\n      v-for="t in threads"\n      :key="t.id"\n      :node="t.node"\n      :title="t.title"\n      :last_modified="t.last_modified"\n      :replies="t.replies"\n      :tid="t.id"\n      :member="t.member"\n    />\n  </view>\n</template>\n\n<script >\nimport Vue from \'vue\'\nimport Loading from \'./loading.vue\'\nimport Thread from \'./thread.vue\'\nexport default {\n  components: {\n    \'loading\': Loading,\n    \'thread\': Thread\n  },\n  props: {\n    threads: {\n      type: Array,\n      default: []\n    },\n    loading: {\n      type: Boolean,\n      default: true\n    }\n  }\n}\n<\/script>\n')),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/components/thread.vue"',title:'"src/components/thread.vue"'},"<template>\n  <view class='thread' @tap=\"handleNavigate\">\n    <view class='info'>\n      <view>\n        <image :src=\"member.avatar_large | url\" class='avatar' />\n      </view>\n      <view class='middle'>\n        <view :class=\"usernameCls\">\n            {{member.username}}\n        </view>\n        <view class='replies'>\n          <text class='mr10'>{{time}}</text>\n          <text>\u8bc4\u8bba {{replies}}</text>\n        </view>\n      </view>\n      <view class='node'>\n        <text class='tag'>{{node.title}}</Text>\n      </view>\n    </view>\n    <text class='title'>{{title}}</text>\n  </view>\n</template>\n\n<script>\nimport Vue from 'vue'\nimport { eventCenter } from '@tarojs/taro'\nimport Taro from '@tarojs/taro'\nimport { timeagoInst, Thread_DETAIL_NAVIGATE } from '../utils'\nimport './thread.css'\nexport default {\n  props: ['title', 'member', 'last_modified', 'replies', 'node', 'not_navi', 'tid'],\n  computed: {\n    time () {\n      return timeagoInst.format(this.last_modified * 1000, 'zh')\n    },\n    usernameCls () {\n      return `author ${this.not_navi ? 'bold' : ''}`\n    }\n  },\n  filters: {\n    url (val) {\n      return 'https:' + val\n    }\n  },\n  methods: {\n    handleNavigate () {\n      const { tid, not_navi } = this.$props\n      if (not_navi) {\n        return\n      }\n      eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.$props)\n      // \u8df3\u8f6c\u5230\u5e16\u5b50\u8be6\u60c5\n      Taro.navigateTo({\n        url: '/pages/thread_detail/thread_detail'\n      })\n    }\n  }\n}\n<\/script>\n")))),(0,a.yg)("p",null,"Here you can see that we have split the forum post rendering logic into two components and placed them in the ",(0,a.yg)("inlineCode",{parentName:"p"},"src/components")," file, as these components are used many times in other pages.\nThe strength of the split is entirely up to the developer, and Taro does not specify that components must be placed in the ",(0,a.yg)("inlineCode",{parentName:"p"},"components")," folder, nor that pages must be placed in the ",(0,a.yg)("inlineCode",{parentName:"p"},"pages")," folder."),(0,a.yg)("p",null,"Another point worth noting is that we don't use HTML components like ",(0,a.yg)("inlineCode",{parentName:"p"},"div"),"/",(0,a.yg)("inlineCode",{parentName:"p"},"span"),", but rather cross-platform components like ",(0,a.yg)("inlineCode",{parentName:"p"},"View"),"/",(0,a.yg)("inlineCode",{parentName:"p"},"Text"),"."),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"The ",(0,a.yg)("a",{parentName:"p",href:"./components-desc"},"cross-platform component library")," of the Taro documentation contains all component parameters and usage. However, the parameters and component names in the component library documentation are currently specific to React (except for React's click event, which is ",(0,a.yg)("inlineCode",{parentName:"p"},"onClick"),").\nFor Vue, component names and component parameters are named in a short horizontal line style (kebab-case), for example: ",(0,a.yg)("inlineCode",{parentName:"p"},'<picker-view indicator-class="myclass" />'))),(0,a.yg)("h3",{id:"router-and-tabbar"},"Router And Tabbar"),(0,a.yg)("p",null,"In the ",(0,a.yg)("inlineCode",{parentName:"p"},"src/components/thread")," component, we pass the"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js"},"Taro.navigateTo({ url: '/pages/thread_detail/thread_detail' })\n")),(0,a.yg)("p",null,"Jump to post details, but this page is still not implemented, now we go to the entry file to configure a new page:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="src/app.config.js"',title:'"src/app.config.js"'},"\nexport default {\n  pages: [\n    'pages/index/index',\n    'pages/thread_detail/thread_detail'\n  ]\n}\n")),(0,a.yg)("p",null,"Then in the path ",(0,a.yg)("inlineCode",{parentName:"p"},"src/pages/thread_detail/thread_detail")," to implement the post details page, the route can be jumped, and our whole process is running up to."),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/pages/thread_detail/thread_detail"',title:'"src/pages/thread_detail/thread_detail"'},"import Taro from '@tarojs/taro'\nimport React from 'react'\nimport { View, RichText, Image } from '@tarojs/components'\nimport { Thread } from '../../components/thread'\nimport { Loading } from '../../components/loading'\nimport api from '../../utils/api'\nimport { timeagoInst, GlobalState } from '../../utils'\n\nimport './index.css'\n\nfunction prettyHTML (str) {\n  const lines = ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6']\n\n  lines.forEach(line => {\n    const regex = new RegExp(`<${line}`, 'gi')\n\n    str = str.replace(regex, `<${line} class=\"line\"`)\n  })\n\n  return str.replace(/<img/gi, '<img class=\"img\"')\n}\n\nclass ThreadDetail extends React.Component {\n  state = {\n    loading: true,\n    replies: [],\n    content: '',\n    thread: {}\n  } as IState\n\n  config = {\n    navigationBarTitleText: 'Topic'\n  }\n\n  componentWillMount () {\n    this.setState({\n      thread: GlobalState.thread\n    })\n  }\n\n  async componentDidMount () {\n    try {\n      const id = GlobalState.thread.tid\n      const [{ data }, { data: [ { content_rendered } ] } ] = await Promise.all([\n        Taro.request({\n          url: api.getReplies({\n            'topic_id': id\n          })\n        }),\n        Taro.request({\n          url: api.getTopics({\n            id\n          })\n        })\n      ])\n      this.setState({\n        loading: false,\n        replies: data,\n        content: prettyHTML(content_rendered)\n      })\n    } catch (error) {\n      Taro.showToast({\n        title: 'Error loading remote data'\n      })\n    }\n  }\n\n  render () {\n    const { loading, replies, thread, content } = this.state\n\n    const replieEl = replies.map((reply, index) => {\n      const time = timeagoInst.format(reply.last_modified * 1000, 'zh')\n      return (\n        <View className='reply' key={reply.id}>\n          <Image src={reply.member.avatar_large} className='avatar' />\n          <View className='main'>\n            <View className='author'>\n              {reply.member.username}\n            </View>\n            <View className='time'>\n              {time}\n            </View>\n            <RichText nodes={reply.content} className='content' />\n            <View className='floor'>\n              {index + 1} floor\n            </View>\n          </View>\n        </View>\n      )\n    })\n\n    const contentEl = loading\n      ? <Loading />\n      : (\n        <View>\n          <View className='main-content'>\n          <RichText nodes={content} />\n          </View>\n          <View className='replies'>\n            {replieEl}\n          </View>\n        </View>\n      )\n\n    return (\n      <View className='detail'>\n        <Thread\n          node={thread.node}\n          title={thread.title}\n          last_modified={thread.last_modified}\n          replies={thread.replies}\n          tid={thread.id}\n          member={thread.member}\n          not_navi={true}\n        />\n        {contentEl}\n      </View>\n    )\n  }\n}\n\nexport default ThreadDetail\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/pages/thread_detail/thread_detail.vue"',title:'"src/pages/thread_detail/thread_detail.vue"'},"\n<template>\n  <view class='detail'>\n    <thread\n      :node=\"topic.node\"\n      :title=\"topic.title\"\n      :last_modified=\"topic.last_modified\"\n      :replies=\"topic.replies\"\n      :tid=\"topic.id\"\n      :member=\"topic.member\"\n      :not_navi=\"true\"\n    />\n    <loading v-if=\"loading\" />\n    <view v-else>\n      <view class='main-content'>\n        <rich-text :nodes=\"content | html\" />\n      </view>\n      <view class='replies'>\n        <view v-for=\"(reply, index) in replies\" class='reply' :key=\"reply.id\">\n          <image :src='reply.member.avatar_large' class='avatar' />\n          <view class='main'>\n            <view class='author'>\n              {{reply.member.username}}\n            </view>\n            <view class='time'>\n              {{reply.last_modified | time}}\n            </view>\n            <rich-text :nodes=\"reply.content_rendered | html\" class='content' />\n            <view class='floor'>\n              {{index + 1}} floor\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport Vue from 'vue'\nimport Taro from '@tarojs/taro'\nimport api from '../../utils/api'\nimport { timeagoInst, GlobalState, IThreadProps, prettyHTML } from '../../utils'\nimport Thread from '../../components/thread.vue'\nimport Loading from '../../components/loading.vue'\nimport './index.css'\nexport default {\n  components: {\n    'loading': Loading,\n    'thread': Thread\n  },\n  data () {\n    return {\n      topic: GlobalState.thread,\n      loading: true,\n      replies: [],\n      content: ''\n    }\n  },\n  async created () {\n    try {\n      const id = GlobalState.thread.tid\n      const [{ data }, { data: [ { content_rendered } ] } ] = await Promise.all([\n        Taro.request({\n          url: api.getReplies({\n            'topic_id': id\n          })\n        }),\n        Taro.request({\n          url: api.getTopics({\n            id\n          })\n        })\n      ])\n      this.loading = false\n      this.replies = data\n      this.content = content_rendered\n    } catch (error) {\n      Taro.showToast({\n        title: 'Error loading remote data'\n      })\n    }\n  },\n  filters: {\n    time (val) {\n      return timeagoInst.format(val * 1000)\n    },\n    html (val) {\n      return prettyHTML(val)\n    }\n  }\n}\n<\/script>\n")))),(0,a.yg)("p",null,'So far, we have implemented all the logic of this application, except for the "node list" page (we will discuss this page component in the advanced guide), and the rest of the pages can be abstracted quickly with the components or pages we have already explained. According to our plan, this application will have five pages, which are'),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Home page, showing the latest posts (completed)"),(0,a.yg)("li",{parentName:"ol"},"Node list"),(0,a.yg)("li",{parentName:"ol"},"Top posts (can be multiplexed by component)"),(0,a.yg)("li",{parentName:"ol"},"node posts (can be multiplexed by component)"),(0,a.yg)("li",{parentName:"ol"},"post details (completed)")),(0,a.yg)("p",null,"The first three of these pages can be planned in ",(0,a.yg)("inlineCode",{parentName:"p"},"tabBar"),", which is Taro's built-in navigation bar that can be configured in ",(0,a.yg)("inlineCode",{parentName:"p"},"app.config.js"),", and the page in the ",(0,a.yg)("inlineCode",{parentName:"p"},"tabBar")," position will display a navigation bar after configuration. Our final ",(0,a.yg)("inlineCode",{parentName:"p"},"app.config.js")," will look like this."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="app.config.js"',title:'"app.config.js"'},"export default {\n  pages: [\n    'pages/index/index',\n    'pages/nodes/nodes',\n    'pages/hot/hot',\n    'pages/node_detail/node_detail',\n    'pages/thread_detail/thread_detail'\n  ],\n  tabBar: {\n    list: [{\n      'iconPath': 'resource/latest.png',\n      'selectedIconPath': 'resource/lastest_on.png',\n      pagePath: 'pages/index/index',\n      text: 'Latest'\n    }, {\n      'iconPath': 'resource/hotest.png',\n      'selectedIconPath': 'resource/hotest_on.png',\n      pagePath: 'pages/hot/hot',\n      text: 'Hot'\n    }, {\n      'iconPath': 'resource/node.png',\n      'selectedIconPath': 'resource/node_on.png',\n      pagePath: 'pages/nodes/nodes',\n      text: 'Node'\n    }],\n    'color': '#000',\n    'selectedColor': '#56abe4',\n    'backgroundColor': '#fff',\n    'borderStyle': 'white'\n  },\n  window: {\n    backgroundTextStyle: 'light',\n    navigationBarBackgroundColor: '#fff',\n    navigationBarTitleText: 'V2EX',\n    navigationBarTextStyle: 'black'\n  }\n}\n")),(0,a.yg)("h2",{id:"project-progression-and-optimization"},"Project Progression and Optimization"),(0,a.yg)("h3",{id:"status-management"},"Status Management"),(0,a.yg)("p",null,"In our implementation of the post component (",(0,a.yg)("inlineCode",{parentName:"p"},"src/components/thread"),"), an event is raised via Taro's built-in ",(0,a.yg)("inlineCode",{parentName:"p"},"eventCenter")," to inject the current post's data into a global ",(0,a.yg)("inlineCode",{parentName:"p"},"GlobalState"),", and then the current post's data is fetched from the ",(0,a.yg)("inlineCode",{parentName:"p"},"GlobalState")," on the post details page - a simple publish/subscribe pattern that is very efficient and clear when dealing with simple logic."),(0,a.yg)("p",null,"Once our business logic becomes complex, a simple publish-subscribe mechanism tied to a global ",(0,a.yg)("inlineCode",{parentName:"p"},"state")," may cause our data flow to become difficult to track. The good thing is that there are good solutions to this problem in both the React and Vue communities. We'll use the two most popular state management tools in the community: ",(0,a.yg)("inlineCode",{parentName:"p"},"Redux")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"Vuex")," to solve this problem."),(0,a.yg)(i.A,{defaultValue:"redux",values:[{label:"Redux",value:"redux"},{label:"Vuex",value:"vuex"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"redux",mdxType:"TabItem"},(0,a.yg)("p",null,"First install ",(0,a.yg)("inlineCode",{parentName:"p"},"redux")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"react-redux"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"npm i redux react-redux\n")),(0,a.yg)("p",null,"Inject ",(0,a.yg)("inlineCode",{parentName:"p"},"context")," into our application using the ",(0,a.yg)("inlineCode",{parentName:"p"},"Provider")," of ",(0,a.yg)("inlineCode",{parentName:"p"},"react-redux")," in the entry file."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="src/app.js"',title:'"src/app.js"'},"import React, { Component } from 'react'\nimport { Provider } from 'react-redux'\nimport { createStore, combineReducers } from 'redux';\nimport './app.css'\n\nconst reducers = combineReducers({\n  thread: (state = {}, action) => {\n    if (action.type === 'SET_CURRENT_THREAD') {\n      return {\n        ...state,\n        ...action.thread\n      }\n    }\n    return state\n  }\n})\n\nconst store = createStore(reducers)\n\nclass App extends Component {\n  render () {\n    // this.props.children is the page that will be rendered\n    return (\n      <Provider store={store}>\n        {this.props.children}\n      </Provider>\n    )\n  }\n}\n\nexport default App\n")),(0,a.yg)("p",null,"Then in the post component we can set the current post via ",(0,a.yg)("inlineCode",{parentName:"p"},"connect")," a ",(0,a.yg)("inlineCode",{parentName:"p"},"dispatch"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/components/thread.jsx"',title:'"src/components/thread.jsx"'},"- eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.props)\n+ this.props.setThread(this.props)\n- export default Thread\n+ const mapDispatchToProps = dispatch => {\n+   return {\n+     setThread: thread => dispatch({ type: 'SET_CURRENT_THREAD', thread })\n+   }\n+ }\n+ export default connect(null, mapDispatchToProps)(Thread)\n")),(0,a.yg)("p",null,"In the post details component we get the data of the current post via ",(0,a.yg)("inlineCode",{parentName:"p"},"connect")," a ",(0,a.yg)("inlineCode",{parentName:"p"},"mapStateToProps"),"."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/components/thread_detail.jsx"',title:'"src/components/thread_detail.jsx"'},"- const id = GlobalState.thread.tid\n+ const id = this.props.thread.tid\n- export default ThreadDetail\n+ function mapStateToProps(state) {\n+  return { thread: state.thread }\n+ }\n+ export default connect(mapStateToProps)(ThreadDetail)\n")),(0,a.yg)("admonition",{title:"Please note",type:"caution"},(0,a.yg)("p",{parentName:"admonition"},"This tutorial demonstrates ",(0,a.yg)("inlineCode",{parentName:"p"},"Redux")," minimalist usage, not best practice. Please visit the ",(0,a.yg)("a",{parentName:"p",href:"https://www.redux.org.cn/"},"Redux documentation")," and the ",(0,a.yg)("a",{parentName:"p",href:"https://react-redux.js.org/introduction/quick-start"},"react-redux documentation")," for details."))),(0,a.yg)(r.A,{value:"vuex",mdxType:"TabItem"},(0,a.yg)("p",null,"First install ",(0,a.yg)("inlineCode",{parentName:"p"},"vuex"),":"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"npm i vuex\n")),(0,a.yg)("p",null,"Inject Vuex's ",(0,a.yg)("inlineCode",{parentName:"p"},"store")," in the entry file."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="src/app.js"',title:'"src/app.js"'},"import Vue from 'vue'\nimport Vuex from 'vuex'\nimport './app.css'\n\nconst store = new Vuex.Store({\n  state: {\n    thread: {}\n  },\n  mutations: {\n    setThread: (state, thread) => {\n      state.thread = { ...thread }\n    }\n  }\n})\n\nconst App = {\n  store,\n  render(h) {\n    // this.$slots.default is the page that will be rendered\n    return h('block', this.$slots.default)\n  }\n}\n\nexport default App\n")),(0,a.yg)("p",null,"Then in the post component we can set the current post with ",(0,a.yg)("inlineCode",{parentName:"p"},"this.$store.setThread()"),"."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/components/thread.vue"',title:'"src/components/thread.vue"'},"- eventCenter.trigger(Thread_DETAIL_NAVIGATE, this.props)\n+ this.$store.setThread(this.$props)\n")),(0,a.yg)("p",null,"Get the data of the current post via ",(0,a.yg)("inlineCode",{parentName:"p"},"computed")," in the post details component."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/components/thread_detail.vue"',title:'"src/components/thread_detail.vue"'},"{\n  data () {\n    return {\n-     topic: GlobalState.thread,\n      loading: true,\n      replies: [],\n      content: ''\n    }\n  },\n+ computed: {\n+  topic() {\n+    return this.$store.state.thread\n+  }\n+ }\n}\n")),(0,a.yg)("admonition",{title:"Please note",type:"caution"},(0,a.yg)("p",{parentName:"admonition"},"This tutorial demonstrates minimalist usage of ",(0,a.yg)("inlineCode",{parentName:"p"},"Vuex"),", not best practices. Please visit the ",(0,a.yg)("a",{parentName:"p",href:"https://vuex.vuejs.org/zh/guide/"},"Vuex documentation")," for details.")))),(0,a.yg)("h4",{id:"other-status-management-tools"},"Other status management tools"),(0,a.yg)("p",null,"In principle, Taro can support any React- or Vue-compatible state management tool, and using such tools usually requires that the ",(0,a.yg)("inlineCode",{parentName:"p"},"context")," be injected into the entry component, and in Taro the entry file cannot render the UI. Just be aware of this."),(0,a.yg)("p",null,"In the Vue ecosystem we recommend using ",(0,a.yg)("inlineCode",{parentName:"p"},"Vuex"),". The React ecosystem has a wide variety of state management tools, and given that many developers using Taro compile their applications into mini programs, we recommend a few state management tools that have performance or size advantages."),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://cn.mobx.js.org/"},(0,a.yg)("inlineCode",{parentName:"a"},"mobx-react")),": Responsive state management tools like Vuex"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://github.com/jamiebuilds/unstated-next"},"unstaged"),":  Minimalist state management tool based on React Hooks, with a compressed size of 200 bytes"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://recoiljs.org/"},"Recoil"),": Facebook's React Hooks-based state management tool")),(0,a.yg)("h3",{id:"css-tools"},"CSS Tools"),(0,a.yg)("p",null,"In Taro, we can freely use CSS pre-processors and post-processors, and it's as simple as adding the relevant plug-ins to the build configuration."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'{8,9,10} title="config/index.js"',"{8,9,10}":!0,title:'"config/index.js"'},"const config = {\n  projectName: 'v2ex',\n  date: '2018-8-3',\n  designWidth: 750,\n  sourceRoot: 'src',\n  outputRoot: 'dist',\n  plugins: [\n    '@tarojs/plugin-sass', // use Sass\n    // '@tarojs/plugin-less', // use Less\n    // '@tarojs/plugin-stylus', // use Stylus\n  ],\n  defineConstants: {\n  },\n  mini: {\n\n  },\n  h5: {\n    publicPath: '/',\n    staticDirectory: 'static',\n    module: {\n      postcss: {\n        autoprefixer: {\n          enable: true\n        }\n      }\n    }\n  }\n}\n\nmodule.exports = function (merge) {\n  if (process.env.NODE_ENV === 'development') {\n    return merge({}, config, require('./dev'))\n  }\n  return merge({}, config, require('./prod'))\n}\n")),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"In addition to CSS preprocessors, Taro also supports ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/css-modules"},"CSS Modules")," and ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/css-in-js"},"CSS-in-JS"),".\nAdditional CSS tools are supported in principle, and we will continue to discuss this in ",(0,a.yg)("a",{parentName:"p",href:"#CustomCompilation"},"Custom Compilation"),".")),(0,a.yg)("h3",{id:"render-html"},"Render HTML"),(0,a.yg)("p",null,"In the post details component (",(0,a.yg)("inlineCode",{parentName:"p"},"ThreadDetail"),"), we use the built-in component ",(0,a.yg)("inlineCode",{parentName:"p"},"RichText")," to render HTML, but this component is not compatible and does not work properly on all ends, and some specific HTML elements cannot be rendered."),(0,a.yg)("p",null,"Fortunately, Taro has built-in HTML rendering, and the usage is not much different from React/Vue for web development."),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/pages/thread_detail/thread_detail.jsx"',title:'"src/pages/thread_detail/thread_detail.jsx"'},"- <RichText nodes={reply.content} className='content' />\n+ <View dangerouslySetInnerHTML={{ __html: reply.content }} className='content'></View>\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/pages/thread_detail/thread_detail.vue"',title:'"src/pages/thread_detail/thread_detail.vue"'},"- <rich-text :nodes=\"reply.content_rendered | html\" class='content' />\n+ <view v-html=\"reply.content_rendered | html\" class='content' />\n")))),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"Taro's built-in HTML rendering features can be used not only in a web development manner, but also support advanced features such as custom styles, custom rendering, and custom events.\nYou can visit the ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/html"},"HTML rendering documentation")," to learn more.")),(0,a.yg)("h3",{id:"performance-optimization"},"Performance Optimization"),(0,a.yg)("h4",{id:"virtual-list"},"Virtual List"),(0,a.yg)("p",null,"In the post list component (",(0,a.yg)("inlineCode",{parentName:"p"},"ThreadList"),"), we render the data directly from the remote. This is not a problem, but if we have very large data, or if the list renders an unusually complex DOM structure, this can create performance issues."),(0,a.yg)("p",null,"To solve this problem, Taro has a built-in ",(0,a.yg)("inlineCode",{parentName:"p"},"VirtualList")," feature that renders only the view of the current visible viewport, rather than rendering all the list data in full."),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/pages/thread_detail/thread_list.jsx"',title:'"src/pages/thread_detail/thread_list.jsx"'},"import React from 'react'\nimport { View, Text } from '@tarojs/components'\nimport { Thread } from './thread'\nimport { Loading } from './loading'\nimport VirtualList from '@tarojs/components-advanced/dist/components/virtual-list'\n\n\nimport './thread.css'\n\nconst Row = React.memo(({ thread }) => {\n  return (\n    <Thread\n      key={thread.id}\n      id={thread.id}\n      node={thread.node}\n      title={thread.title}\n      last_modified={thread.last_modified}\n      replies={thread.replies}\n      tid={thread.id}\n      member={thread.member}\n    />\n  )\n})\n\nclass ThreadList extends React.Component {\n  static defaultProps = {\n    threads: [],\n    loading: true\n  }\n\n  render () {\n    const { loading, threads } = this.props\n\n    if (loading) {\n      return <Loading />\n    }\n\n    const element = (\n      <VirtualList\n        height={800} /* list height */\n        width='100%' /* list width */\n        itemData={threads} /* list render data */\n        itemCount={threads.length} /*   Length of the rendering list */\n        itemSize={100} /* The height of a single item in the list  */\n      >\n        {Row}\n      </VirtualList>\n    )\n\n    return (\n      <View className='thread-list'>\n        {element}\n      </View>\n    )\n  }\n}\n\nexport { ThreadList }\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="app.js"',title:'"app.js"'},"// Add a new use plugin to the entry file\nimport VirtualList from '@tarojs/components-advanced/dist/components/virtual-list'\nVue.use(VirtualList)\n")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/components/row.vue"',title:'"src/components/row.vue"'},'<template>\n  <thread\n    :key="thread.id"\n    :node="thread.node"\n    :title="thread.title"\n    :last_modified="thread.last_modified"\n    :replies="thread.replies"\n    :tid="thread.id"\n    :member="thread.member"\n  />\n</template>\n\n<script>\nimport Thread from \'./thread.vue\'\nexport default {\n  components: {\n    \'thread\': Thread\n  },\n  props: [\'index\', \'data\', \'css\'],\n  computed:{\n    thread(){\n      return this.data[this.index]\n    }\n  }\n}\n<\/script>\n')),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/components/thread_list.vue"',title:'"src/components/thread_list.vue"'},"<template>\n  <view className='thread-list'>\n    <loading v-if=\"loading\" />\n    <virtual-list\n      v-else\n      :height=\"500\"\n      :item-data=\"threads\"\n      :item-count=\"threads.length\"\n      :item-size=\"100\"\n      :item=\"Row\"\n      width=\"100%\"\n    />\n  </view>\n</template>\n\n<script >\nimport Vue from 'vue'\nimport Loading from './loading.vue'\nimport Thread from './thread.vue'\nimport Row from './row.vue'\nexport default {\n  components: {\n    'loading': Loading,\n    'thread': Thread\n  },\n  props: {\n    threads: {\n      type: Array,\n      default: []\n    },\n    loading: {\n      type: Boolean,\n      default: true\n    }\n  }\n}\n<\/script>\n")))),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"In the documentation ",(0,a.yg)("a",{parentName:"p",href:"./virtual-list"},"virtual-list")," you can find some advanced uses of virtual lists, such as: infinite scrolling, scroll offsets, scroll events, etc.")),(0,a.yg)("h4",{id:"prerender"},"Prerender"),(0,a.yg)("p",null,"Now let's implement the last page: the node list page. This page essentially renders a huge list that exists locally:"),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src/pages/nodes/nodes.jsx"',title:'"src/pages/nodes/nodes.jsx"'},"import React from 'react'\nimport { View, Text, Navigator } from '@tarojs/components'\nimport allNodes from './all_node'\nimport api from '../../utils/api'\n\nimport './nodes.css'\n\nfunction Nodes () {\n  const element = allNodes.map(item => {\n    return (\n      <View key={item.title} className='container'>\n        <View className='title'>\n          <Text style='margin-left: 5px'>{item.title}</Text>\n        </View>\n        <View className='nodes'>\n          {item.nodes.map(node => {\n            return (\n              <Navigator\n                className='tag'\n                url={`/pages/node_detail/node_detail${api.queryString(node)}`}\n                key={node.full_name}\n              >\n                <Text>{node.full_name}</Text>\n              </Navigator>\n            )\n          })}\n        </View>\n      </View>\n    )\n  })\n  return <View className='node-container'>{element}</View>\n}\n\nexport default Nodes\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-html",metastring:'title="src/pages/nodes/nodes.vue"',title:'"src/pages/nodes/nodes.vue"'},"<template>\n  <view class='node-container'>\n    <view v-for=\"item in allNodes\" :key=\"item.title\" class='container'>\n      <view class='title'>\n        <text style='margin-left: 5px'>{{item.title}}</text>\n      </view>\n      <view class='nodes'>\n        <navigator\n          v-for=\"node in item.nodes\"\n          :key=\"node.full_name\"\n          class='tag'\n          :url=\"node | url\"\n        >\n          <text>{{node.full_name}}</text>\n        </navigator>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport Vue from 'vue'\nimport allNodes from './all_node'\nimport api from '../../utils/api'\nimport './nodes.css'\n\nfunction getURL (node) {\n  return `/pages/node_detail/node_detail${api.queryString(node)}`\n}\n\nexport default {\n  data () {\n    return {\n      allNodes\n    }\n  },\n  filters: {\n    url (node) {\n      return getURL(node)\n    }\n  }\n}\n<\/script>\n")))),(0,a.yg)("p",null,"This time our whole application is finished. However, if you put this app in a real mini program, especially in some real machines with low performance, it may take longer to switch to this page and there will be a white screen time."),(0,a.yg)("p",null,"This is due to Taro's rendering mechanism: during page initialization, native mini program can fetch data directly from local rendering, but Taro renders the initial data into a DOM tree via React/Vue, then serializes the DOM tree and gives it to the mini program to render. This means that Taro spends one more time calling the ",(0,a.yg)("inlineCode",{parentName:"p"},"setData")," function on page initialization than native mini programs do - and most mini program performance problems are caused by oversized ",(0,a.yg)("inlineCode",{parentName:"p"},"setData")," data."),(0,a.yg)("p",null,"To solve this problem, Taro has introduced a technology called Prerender, which, like server-side rendering, converts the pages to be rendered directly into ",(0,a.yg)("inlineCode",{parentName:"p"},"wxml")," strings in the Taro CLI, resulting in the same or even faster speeds than native mini program."),(0,a.yg)("p",null,"Using prerender is also very simple, we just need to do a simple configuration:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'{4-6} title="config/prod.js"',"{4-6}":!0,title:'"config/prod.js"'},"const config = {\n  ...\n  mini: {\n    prerender: {\n      include: ['pages/nodes/nodes'], // `pages/nodes/nodes`\n    }\n  }\n};\n\n// We only turn on pre-rendering here when we compile for production mode\n// If you need to turn it on during development, then put the configuration in `config/index` or `config/dev`\nmodule.exports = config\n")),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"The configuration of prerender supports conditional rendering pages, conditional rendering logic, custom rendering functions, etc. For details, visit the ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/prerender"},"pre-rendering documentation"),".")),(0,a.yg)("h3",{id:"packing-volume"},"Packing volume"),(0,a.yg)("p",null,"By default using production mode packaging, Taro will optimize the packaging volume for you. However, it is worth noting that Taro's default packaging configuration is designed to work for most projects and requirements, and is not optimal for any project. So you can build on top of the Taro configuration and optimize it for your own project."),(0,a.yg)("h4",{id:"javascript"},"JavaScript"),(0,a.yg)("p",null,"In Taro applications, all Java(Type)Script is configured via ",(0,a.yg)("inlineCode",{parentName:"p"},"babel.config.js"),", specifically using the ",(0,a.yg)("a",{parentName:"p",href:"https://www.npmjs.com/package/babel-preset-taro"},(0,a.yg)("inlineCode",{parentName:"a"},"babel-prest-taro"))," Babel plugin is compiled."),(0,a.yg)("p",null,"By default Taro is compatible with all syntaxes supported by ",(0,a.yg)("a",{parentName:"p",href:"https://www.npmjs.com/package/@babel/preset-env"},(0,a.yg)("inlineCode",{parentName:"a"},"@babel/preset-env"))," and is compatible with ",(0,a.yg)("inlineCode",{parentName:"p"},"iOS 9")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"Android 5"),", but if you don't need that high compatibility or don't need If you don't need that much compatibility or don't need some ES2015+ syntax support, you can configure ",(0,a.yg)("inlineCode",{parentName:"p"},"babel.config.js")," yourself to reduce the package size."),(0,a.yg)("p",null,"For example, we can upgrade the compatibility to ",(0,a.yg)("inlineCode",{parentName:"p"},"iOS 12"),"."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="babel.config.js"',title:'"babel.config.js"'},"// babel.config.js\nmodule.exports = {\n  presets: [\n    ['taro', {\n      targets: {\n        ios: '12'\n      }\n    }]\n  ]\n}\n")),(0,a.yg)("p",null,"You can visit the ",(0,a.yg)("a",{parentName:"p",href:"https://babeljs.io/"},"Babel documentation")," for more information on customizing your configuration."),(0,a.yg)("h4",{id:"packaged-volume-analysis"},"Packaged volume analysis"),(0,a.yg)("p",null,"Taro uses ",(0,a.yg)("a",{parentName:"p",href:"https://www.webpackjs.com/"},"Webpack")," as its internal packaging system, and sometimes Webpack doesn't give us the ",(0,a.yg)("inlineCode",{parentName:"p"},"tree-shaking")," effect when our business code uses the ",(0,a.yg)("inlineCode",{parentName:"p"},"require")," syntax or the ",(0,a.yg)("inlineCode",{parentName:"p"},"import default")," syntax. . In such cases we use ",(0,a.yg)("a",{parentName:"p",href:"https://www.npmjs.com/package/webpack-bundle-analyzer"},(0,a.yg)("inlineCode",{parentName:"a"},"webpack-bundle-analyzer"))," to analyze our dependency packaging volume, and this plugin opens a visual graphical page in our browser telling us reference the volume of each package."),(0,a.yg)("p",null,"First install the ",(0,a.yg)("inlineCode",{parentName:"p"},"webpack-bundle-analyzer")," dependency:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},"npm install webpack-bundle-analyzer -D\n")),(0,a.yg)("p",null,"And then addd the following configuration to the ",(0,a.yg)("a",{parentName:"p",href:"./config-detail/#miniwebpackchain-1"},"mini.webpackChain"),"\uff1a"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'{4-7} title="config/index"',"{4-7}":!0,title:'"config/index"'},"const config = {\n  ...\n  mini: {\n    webpackChain (chain, webpack) {\n      chain.plugin('analyzer')\n        .use(require('webpack-bundle-analyzer').BundleAnalyzerPlugin, [])\n    }\n  }\n}\n")),(0,a.yg)("p",null,"After running the compile command you can see the file dependencies and volumes."),(0,a.yg)("p",null,"You can visit the ",(0,a.yg)("a",{parentName:"p",href:"https://www.npmjs.com/package/webpack-bundle-analyzer"},"webpack-bundle-analyzer")," documentation for detailed usage."),(0,a.yg)("h4",{id:"subpackages"},"SubPackages"),(0,a.yg)("p",null,"In some cases, we want our pages to be loaded on demand only when they are used. This is called subpackaging in the Taro application, and it is very simple to use, just by configuring the entry file ",(0,a.yg)("inlineCode",{parentName:"p"},"app.config.js"),"."),(0,a.yg)("p",null,"Suppose we need to subpackage all the node pages that we have just implemented for pre-rendering."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'title="src/app.config.js"',title:'"src/app.config.js"'},"export default {\n  pages: [\n    'pages/index/index',\n    // 'pages/nodes/nodes', Remove the pages to be subpackaged from the `pages` field\n    'pages/hot/hot',\n    'pages/node_detail/node_detail',\n    'pages/thread_detail/thread_detail'\n  ],\n  // Add subpackages to the `subpackages` field, and if the target is an Alipay mini program, you need to add a field `subPackages` with the same value as `subpackages`\n  // Can't be in the `pages` root directory nor outside the pages directory, you need to create a new folder in the `pages` root directory for subpackages\n  \"subpackages\": [\n    {\n      \"root\": \"pages\",\n      \"pages\": [\n        \"nodes/nodes\"\n      ]\n    }\n  ]\n  tabBar: {\n    list: [{\n      'iconPath': 'resource/latest.png',\n      'selectedIconPath': 'resource/lastest_on.png',\n      pagePath: 'pages/index/index',\n      text: 'latest'\n    }, {\n      'iconPath': 'resource/hotest.png',\n      'selectedIconPath': 'resource/hotest_on.png',\n      pagePath: 'pages/hot/hot',\n      text: 'hot'\n    }, {\n      // \u5982\u679c\u662f\u5206\u5305\u7684\u5b50\u9875\u9762\uff0c\u5c31\u4e0d\u80fd\u5728 `tabBar` \u4e2d\u4f7f\u7528\n      'iconPath': 'resource/node.png',\n      'selectedIconPath': 'resource/node_on.png',\n      pagePath: 'pages/nodes/nodes',\n      text: 'node'\n    }],\n    'color': '#000',\n    'selectedColor': '#56abe4',\n    'backgroundColor': '#fff',\n    'borderStyle': 'white'\n  },\n  window: {\n    backgroundTextStyle: 'light',\n    navigationBarBackgroundColor: '#fff',\n    navigationBarTitleText: 'V2EX',\n    navigationBarTextStyle: 'black'\n  }\n}\n")),(0,a.yg)("h3",{id:"custom-compilation"},"Custom Compilation"),(0,a.yg)("p",null,"In specific cases where Taro's own compilation system does not meet our compilation needs, Taro offers two options for extending the compilation."),(0,a.yg)("h4",{id:"extending-with-webpack"},"Extending with Webpack"),(0,a.yg)("p",null,"In ","[package volume analysis]","(#package volume analysis) we added a Webpack plugin to ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/config-detail/#miniwebpackchain-1"},"mini.webpackChain")," and added a Webpack plugin to ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/config-detail/#miniwebpackchain-1"},"mini.webpackChain")," to achieve the effect of packing volume/dependency analysis."),(0,a.yg)("p",null,"In fact with the ",(0,a.yg)("inlineCode",{parentName:"p"},"mini.webpackChain")," configuration we can use almost any plugin and ",(0,a.yg)("inlineCode",{parentName:"p"},"loader")," from the Webpack ecosystem, for example if we want to use ",(0,a.yg)("inlineCode",{parentName:"p"},"CoffeeScript")," for development."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'{4-7} title="config/index"',"{4-7}":!0,title:'"config/index"'},"const config = {\n  ...\n  mini: {\n    webpackChain (chain, webpack) {\n      chain.merge({\n          module: {\n              rule: {\n                  test: /\\.coffee$/,\n                  use: [ 'coffee-loader' ]\n              }\n          }\n      })\n    }\n  }\n}\n")),(0,a.yg)("p",null,"Similarly, the ",(0,a.yg)("inlineCode",{parentName:"p"},"CSS Modules")," that we mentioned before can be extended with support in the form of Webpack. For more information, visit the ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/neutrinojs/webpack-chain"},"webpack-chain")," documentation for details on how to use it."),(0,a.yg)("h4",{id:"expansion-with-plugin-system"},"Expansion with plugin system"),(0,a.yg)("p",null,"At ","[CSS Tools]","(#CSS Tools) we have used a plugin called ",(0,a.yg)("inlineCode",{parentName:"p"},"@tarojs/plugin-sass")," to implement support for ",(0,a.yg)("inlineCode",{parentName:"p"},"Sass"),". Instead of using Webpack extensions to compile, Taro's plugin functionality eliminates the need to configure Webpack on each end and just uses the plugin."),(0,a.yg)("p",null,"In addition, Taro's plugin functionality extends the Taro CLI compilation commands, the compilation process, and the compilation platform, and you can visit the ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/plugin"},"plug-in functionality documentation")," for more information on custom configuration."),(0,a.yg)("admonition",{title:"to learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"In addition to the above two methods, Taro also offers a number of compile-related options, which you can learn more about by visiting the ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/config-detail"},"compile configuration details")," documentation to learn more.")),(0,a.yg)("h2",{id:"multi-ended-development"},"Multi-Ended Development"),(0,a.yg)("h3",{id:"cross-platform-development"},"Cross-platform development"),(0,a.yg)("p",null,'In some cases, the performance or business logic of different platforms is qualitatively different. In such cases, there is no way for us to do "one set of code for all".'),(0,a.yg)("p",null,"For example, if we are implementing a V2EX forum application, the current API has no way to be called across domains in the browser, so we need to use another copy of the API on the H5 side, which we can solve by using the built-in environment variables."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff"},"- import api from '../../utils/api'\n// We can introduce different APIs depending on the platform\n+ let api\n+ if (process.env.TARO_ENV === 'weapp') {\n+  api = require('../../utils/api-weapp')\n+ } else if (process.env.TARO_ENV === 'h5') {\n+  api = require('../../utils/api-h5')\n+ }\n")),(0,a.yg)("p",null,"Taro also provides ",(0,a.yg)("a",{parentName:"p",href:"/taro-docs/en/docs/envs#uniform-interface-for-multi-terminal-files"},"unified interface for multi-terminal files"),"\uff0cFinding dependencies by different nomenclature, in such cases we can keep."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js"},"import api from '../../utils/api'\n")),(0,a.yg)("p",null,"statement as is, modify our file structure by adding the name of the platform between the file name and the suffix name:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-bash"},".\n\u2514\u2500\u2500 utils\n    \u251c\u2500\u2500 api.h5.js\n    \u251c\u2500\u2500 api.weapp.js\n    \u2514\u2500\u2500 index.js\n")),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},'In addition to the "built-in environment variables" and "unified interface for multiple files", Taro also offers other cross-platform development solutions, which you can learn more about by visiting the documentation ',(0,a.yg)("a",{parentName:"p",href:"./envs"},"cross-platform development")," to learn more.")),(0,a.yg)("h3",{id:"synchronized-debugging"},"Synchronized debugging"),(0,a.yg)("p",null,"By default, Taro puts all the packaged files on each side in the ",(0,a.yg)("inlineCode",{parentName:"p"},"dist")," directory. If you want to synchronize debugging on multiple ends, the files compiled first will be overwritten by the files compiled later."),(0,a.yg)("p",null,"However, we can synchronize debugging by modifying the ",(0,a.yg)("inlineCode",{parentName:"p"},"outputRoot")," of the compilation configuration."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js",metastring:'{2} title="config/index.js"',"{2}":!0,title:'"config/index.js"'},"const config = {\n  outputRoot: `dist/${process.env.TARO_ENV}`\n}\n")),(0,a.yg)("p",null,"Under this configuration, the compiled directory of Wechat mini programs will be ",(0,a.yg)("inlineCode",{parentName:"p"},"dist/weapp")," and the compiled directory of H5 will be ",(0,a.yg)("inlineCode",{parentName:"p"},"dist/h5"),"."),(0,a.yg)("h3",{id:"using-native-mini-program-components"},"Using native mini program components"),(0,a.yg)("p",null,"In some cases we need to reuse the existing ecology of the mini program, and the components/libraries of the mini program are usually written for the specific mini program and can't be used directly on Taro, requiring some additional operations."),(0,a.yg)("p",null,"For example, in our forum application, the post details may be returned in MarkDown format on the server side, so we need ",(0,a.yg)("inlineCode",{parentName:"p"},"towxml")," to render our posts."),(0,a.yg)("p",null,"First we need to reference ",(0,a.yg)("inlineCode",{parentName:"p"},"towxml")," in the configuration file of the post details page:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-js"},'export default {\n  "usingComponents": {\n    "towxml":"../../towxml/towxml"\n  }\n}\n')),(0,a.yg)("p",null,"Then using the ",(0,a.yg)("inlineCode",{parentName:"p"},"towxml")," component, it's important to remember that whether it's React or Vue, the native mini program component declaration needs to be lowercase"),(0,a.yg)(i.A,{defaultValue:"React",values:[{label:(0,a.yg)(o.vR,{mdxType:"ReactIcon"}),value:"React"},{label:(0,a.yg)(o.oS,{mdxType:"VueIcon"}),value:"Vue"}],mdxType:"Tabs"},(0,a.yg)(r.A,{value:"React",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/pages/thread_detail/thread_detail.jsx"',title:'"src/pages/thread_detail/thread_detail.jsx"'},"- <View dangerouslySetInnerHTML={{ __html: reply.content }} className='content'></View>\n+ <towxml nodes=\"{{reply.content}}\" />\n"))),(0,a.yg)(r.A,{value:"Vue",mdxType:"TabItem"},(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-diff",metastring:'title="src/pages/thread_detail/thread_detail.vue"',title:'"src/pages/thread_detail/thread_detail.vue"'},'- <view v-html="reply.content_rendered | html" class=\'content\' />\n+ <towxml :nodes="reply.content_rendered | html" />\n')))),(0,a.yg)("p",null,"Finally, just follow the ",(0,a.yg)("a",{parentName:"p",href:"https://github.com/sbfkcel/towxml/wiki/3.0-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8"},"towxml")," document to call it."),(0,a.yg)("admonition",{title:"Please note",type:"caution"},(0,a.yg)("p",{parentName:"admonition"},"Once the native mini program component is used, the Taro app loses its cross-over capabilities.")),(0,a.yg)("admonition",{title:"Learn more",type:"info"},(0,a.yg)("p",{parentName:"admonition"},"Taro also supports the use of mini program plugins, for details visit the documentation ",(0,a.yg)("a",{parentName:"p",href:"./taro-in-miniapp"},"Using native third-party components and plugins for mini programs"),".")))}f.isMDXComponent=!0}}]);